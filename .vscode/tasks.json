{
    // See https://go.microsoft.com/fwlink/?LinkId=733558
    // for the documentation about the tasks.json format
    "version": "2.0.0",
    "tasks": [
        
        // the following "fx_task" tasks are intended to be triggered by the corresponding f key.
        // In order for this to work, you must define keybindings like the following, which you shouild place in vs code's keybindings.json file.:
        //   { "key": "f4"  ,  "command": "workbench.action.tasks.runTask"     ,    "args": "f4_task"    }
        { "label": "f4_task",            "dependsOn": ["run_design1_with_debugging"]                           },
        { "label": "f7_task",            "dependsOn": ["run_rpyc_playground"]                                  },
        { "label": "f8_task",            "dependsOn": ["reload_fusion_script_runner_addin_with_keystrokes"]    },
        { "label": "f9_task",            "dependsOn": ["run_script_in_fusion_without_debugging"]               },



        {
            "label": "execute_with_python",
            "type":"shell",
            "command": "${config:python.pythonPath} \"${file}\""
        },
        {
            "label": "run_rpyc_playground",
            "type":"shell",
            "command": "${config:python.pythonPath} \"${workspaceFolder}${pathSeparator}rpyc_playground.py\""
        },

        {
            "label": "reload_fusion_script_runner_addin_with_keystrokes",
            "type":"shell",
            "command": "autohotkey \"${workspaceFolder}${pathSeparator}reload_fusion_addin.ahk\" fusion_script_runner_addin\"",
            "presentation": {
                "reveal": "always",
                "showReuseMessage": false
                }
        },
        {
            "label": "monitor_fusion_script_runnner_addin_log",
            "type":"shell",
            "command": "tail -F '${workspaceFolder}${pathSeparator}fusion_script_runner_addin${pathSeparator}fusion_script_runner_addin_log.log'",
            "presentation": {
                "reveal": "always",
                "showReuseMessage": false
                },
            "options": {"shell": {"executable": "C:\\cygwin64\\bin\\bash.exe","args": ["-c"]}},
            "isBackground":true,

        },
        {
            "label": "reload_fusion_script_runner_addin_then_monitor_log",
            "dependsOrder": "sequence",
            "dependsOn": [
                "reload_fusion_script_runner_addin_with_keystrokes",
                "monitor_fusion_script_runnner_addin_log"
            ]
        },
        {
            "label":"kill_fusion",
            "type":"shell",
            "command": "(tasklist | grep Fusion360.exe) &&  (taskkill /f /t /im Fusion360.exe & sleep 3)  & exit 0",
            "presentation": {
                "reveal": "silent",
                "panel":  "dedicated",
                "showReuseMessage": false,
                "close": true
            }
        },
        {
            "label":"run_fusion",
            "type":"shell",
            "command": "Fusion360 --nologo",
            "presentation": {
                "reveal": "silent",
                "panel":  "dedicated",
                "showReuseMessage": false,
                "close": false
            }
        },
        {
            "label":"run_fusion_with_debugpy_log_dir_defined",
            "type":"shell",
            "command": "Fusion360 --nologo",
            "presentation": {
                "reveal": "silent",
                "panel":  "dedicated",
                "showReuseMessage": false,
                "close": false
            },
            "options": {
                "env": {
                    "DEBUGPY_LOG_DIR":"C:/work/fusion_programmatic_experiment/debugpy_log"
                }
            }
        },
        {
            "label":"restart_fusion",
            "dependsOn":["kill_fusion", "run_fusion"],
            "dependsOrder": "sequence"
        },
        {
            "label":"restart_fusion_with_debugpy_log_dir_defined",
            "dependsOn":["kill_fusion", "run_fusion_with_debugpy_log_dir_defined"],
            "dependsOrder": "sequence"
        },
        // {
        //     "label":"restart_fusion_with_debugpy_log_dir_defined",
        //     "type":"shell",
        //     "command": "taskkill /f /t /im Fusion360.exe & (set \"DEBUGPY_LOG_DIR=C:/work/fusion_programmatic_experiment/debugpy_log\" && start \"\" Fusion360 --nologo)",
        //     "presentation": {"reveal": "silent"}            
        // },
        {
            "label":"monitor_the_log",
            "type":"shell",
            "command": "tail -F \"${env:TEMP}${pathSeparator}fusion_script_runner_addin_log.log\"",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel":  "dedicated",
                "showReuseMessage": false,
                "clear": false
            },
            "isBackground": true
        },
        {
            "label":"run_script_in_fusion_without_debugging",
            "type":"shell",
            "command": "${config:python.pythonPath} \"${workspaceFolder}${pathSeparator}fusion_script_runner_addin${pathSeparator}run_script_in_fusion.py\"",
            "args":[
                "--script", "${file}",
                "--debug", "0",
                "--debugpy_path", "${config:neil.debugpyPath}",
                "--addin_port", "19812",
                "--debug_port", "9000"
            ]
        },
        {
            "label":"run_script_in_fusion_with_debugging",
            "type":"shell",
            "command": "${config:python.pythonPath} \"${workspaceFolder}${pathSeparator}fusion_script_runner_addin${pathSeparator}run_script_in_fusion.py\"",
            "args":[
                "--script", "${file}",
                "--debug", "1",
                "--debugpy_path", "${config:neil.debugpyPath}",
                "--addin_port", "19812",
                "--debug_port", "9000"
            ]
        },
        {
            "label":"run_test_script_in_fusion_without_debugging",
            "type":"shell",
            "command": "${config:python.pythonPath} \"${workspaceFolder}${pathSeparator}fusion_script_runner_addin${pathSeparator}run_script_in_fusion.py\"",
            "args":[
                "--script", "${workspaceFolder}${pathSeparator}test_scripts${pathSeparator}arbitrary_script_1${pathSeparator}arbitrary_script_1.py",
                "--debug", "0",
                "--debugpy_path", "${config:neil.debugpyPath}",
                "--addin_port", "19812",
                "--debug_port", "9000"
            ]
        },
        {
            "label":"run_test_script_in_fusion_with_debugging",
            "type":"shell",
            "command": "${config:python.pythonPath} \"${workspaceFolder}${pathSeparator}fusion_script_runner_addin${pathSeparator}run_script_in_fusion.py\"",
            "args":[
                "--script", "${workspaceFolder}${pathSeparator}test_scripts${pathSeparator}arbitrary_script_1${pathSeparator}arbitrary_script_1.py",
                "--debug", "1",
                "--debugpy_path", "${config:neil.debugpyPath}",
                "--addin_port", "19812",
                "--debug_port", "9000"
            ]
        },
        {
            "label":"run_design1_with_debugging",
            "type":"shell",
            "command": "${config:python.pythonPath} \"${workspaceFolder}${pathSeparator}fusion_script_runner_addin${pathSeparator}run_script_in_fusion.py\"",
            "args":[
                "--script", "${workspaceFolder}${pathSeparator}design1.py",
                "--debug", "1",
                "--debugpy_path", "${config:neil.debugpyPath}",
                "--addin_port", "19812",
                "--debug_port", "9000",
                "--prefix_of_submodule_not_to_be_reloaded", "braids.fscad"
            ],
            "presentation": {"reveal" : "silent" }
        },
        {
            "label":"hello_world",
            "type":"shell",
            // "command": "echo ${config:python.pythonPath}",
            // "command": "echo ${config:python.analysis.symbolsHierarchyDepthLimit}",
            // "command": "echo here it is ${config:python.analysis}",
            // "command": "echo here it is ${config:neil.debugpyPath}",
            // "command": "echo here it is ${config:neil.x}",
            "command": "echo here it is ${config:python.autoComplete.extraPaths}",
            // "command": "echo here it is $(echo ahoy)",
        }
    ],
    "inputs": [
      {
        "id": "terminate",
        "type": "command",
        "command": "workbench.action.tasks.terminate",
        "args": "terminateAll"
      }
    ]

}